image: index.docker.io/guligo/jdk-maven-ant-tomcat:latest

services:
    - mathbeta
env:
    - MYENV = "hello"

install:
    - echo $MYENV
    - pwd
    - apt-get install -y git-core

before_script:
    - echo $MYENV
    - rm -rf $CATALINA_HOME/webapps/ROOT/*
    - ant -f build.xml
    - cp -r /root/mathbeta/WebRoot/* $CATALINA_HOME/webapps/ROOT
    - bash $CATALINA_HOME/bin/startup.sh

script:
    - echo $MYENV
    - curl http://127.0.0.1:8080/test.do?a=mytest
    - curl http://127.0.0.1:8080/userlist.do